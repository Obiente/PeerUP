---
export interface Props {
  icon: `${string}:${string}`;
  class?: string;
}
const { icon, class: className = "" }: Props = Astro.props;
import { getIconData, iconToSVG, iconToHTML, replaceIDs } from "@iconify/utils";

const [iconPack, iconName] = icon.split(":");
const { icons } = await import(`@iconify-json/${iconPack}`).catch(() => {
  throw new Error(`Icon pack '${iconPack}' not found.`, {cause: this});
});

let iconData = getIconData(icons, iconName);
if (!iconData) {
  throw new Error(`Icon '${iconName}' not found in pack '${iconPack}'.`);
}

if (!iconData) {
  return;
}

const renderData = iconToSVG(iconData, {
  height: "auto",
});
const svg = iconToHTML(replaceIDs(renderData.body), renderData.attributes);
---

<span class={className} set:html={svg} />
