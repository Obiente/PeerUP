---
export const prerender = true;
import { ICONS, getIcon } from "$lib/design-system";
export interface Props {
  size?: string;
  icon: keyof typeof ICONS;
  class?: string;
}
const { icon, class: className = "", size = "20" } = Astro.props;
import { getIconData, iconToSVG, iconToHTML, replaceIDs } from "@iconify/utils";

if (!icon) {
  return;
}
const [iconPack, iconName] = getIcon(icon).split(":");
const { icons } = await import(`@iconify-json/${iconPack}`).catch(() => {
  throw new Error(`Icon pack '${iconPack}' not found.`, { cause: this });
});

let iconData = getIconData(icons, iconName);
if (!iconData) {
  throw new Error(`Icon '${iconName}' not found in pack '${iconPack}'.`);
}

const renderData = iconToSVG(iconData, {
  width: "auto",
  height: size,
});
const svg = iconToHTML(replaceIDs(renderData.body), renderData.attributes);
---

<span class={className} set:html={svg} />
